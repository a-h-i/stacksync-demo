# Minimal schema-valid nsjail config for Python sandbox

mode: ONCE
hostname: "nsjail"

time_limit: 5
max_cpus: 1

# ========== UID/GID mappings ==========
uidmap {
  inside_id: "65534"
  outside_id: "65534"
  count: 1
}
gidmap {
  inside_id: "65534"
  outside_id: "65534"
  count: 1
}

clone_newns: false
clone_newpid: false

keep_caps: false
keep_env: false

envar: "PYTHONUNBUFFERED=1"
envar: "PYTHONNOUSERSITE=1"
envar: "LC_ALL=C.UTF-8"

# ========== Resource limits ==========
rlimit_as: 512
rlimit_cpu: 4
rlimit_fsize: 16
rlimit_nofile: 128
rlimit_nproc: 64
rlimit_stack: 16

# ========== Mounts ==========
mount {
  src: "/usr"
  dst: "/usr"
  is_bind: true
  rw: false
}
mount {
  src: "/bin"
  dst: "/bin"
  is_bind: true
  rw: false
}
mount {
  src: "/lib"
  dst: "/lib"
  is_bind: true
  rw: false
}
mount {
  src: "/lib64"
  dst: "/lib64"
  is_bind: true
  rw: false
}
mount {
  dst: "/tmp"
  fstype: "tmpfs"
  rw: true
}
mount {
  src: "/dev/null"
  dst: "/dev/null"
  is_bind: true
  rw: false
}
mount {
  src: "/dev/urandom"
  dst: "/dev/urandom"
  is_bind: true
  rw: false
}
